!function(n){"use strict";n.module("ngLazy",["ngLazy.factories","ngLazy.directives"])}(angular),angular.module("ngLazy.directives",[]).directive("lazyLoad",["$injector","$window","$document","$timeout","$rootScope",function(n,e,a,t,o){var r=function(){var n=document.createElement("style"),e="@-webkit-keyframes spin {\n	0%{-webkit-transform: rotate(0deg);}\n	100%{-webkit-transform: rotate(360deg);}\n}\n@keyframes spin{\n	0%{transform: rotate(0deg);}\n	100%{transform: rotate(360deg);}\n}";n.innerHTML=e,document.head.appendChild(n)},i=function(n,e){return n.css({WebkitBoxSizing:"border-box",boxSizing:"border-box",display:"block",width:"43px",height:"43px",margin:"20px auto",borderWidth:"8px",borderStyle:"solid",borderColor:e,borderRadius:"22px",animation:"spin 0.8s linear infinite",WebkitAnimation:"spin 0.8s linear infinite"}),n};return{restrict:"E",scope:{lazyData:"=",lazyDataCollectionKey:"@",lazyDataService:"@",lazyFetchMethod:"@",lazyRange:"@",lazyDataKeys:"=",lazyStartDelay:"@",lazyAppendDelay:"@",lazySpinnerColor:"@"},transclude:!0,template:"<div ng-transclude></div><div class='col-md-12 loading' ng-hide='spinner.hide'><div class='loading-widget'></div></div><div id='lazy-bottom'></div>",link:function(a){var l=function(n,e){return n-3*e},c=function(){return s.document.body.scrollHeight},d=angular.element(e),s=d[0],u=angular.element(document.querySelector("#lazy-bottom")),y=c(),g=u&&y-u.offsetTop||100,f=l(y,g),p=angular.element(document.querySelector(".loading-widget")),z=n.get("lazyLoader"),h=n.get(a.lazyDataService),m=!1,b=!0,v={};r(),p=i(p,"transparent "+a.lazySpinnerColor+" "+a.lazySpinnerColor+" "+a.lazySpinnerColor||"transparent rgb(85, 148, 250) rgb(85, 148, 250) rgb(85, 148, 250)"),a.spinner={hide:!1};var D=function(){return v.data=a.lazyData,v.collectionKey=a.lazyDataCollectionKey,v.fetchData=h[a.lazyFetchMethod],v.range=a.lazyRange,v.dataKeys=a.lazyDataKeys,v.startDelay=a.lazyStartDelay,v.appendDelay=a.lazyAppendDelay,v.spinnerColor=a.lazySpinnerColor,v},S=function(){v=D(),z.configure(v),a.$watch("spinnerColor",function(){angular.element(p.css({borderColor:"transparent "+a.lazySpinnerColor+" "+a.lazySpinnerColor+" "+a.lazySpinnerColor||"transparent rgb(85, 148, 250) rgb(85, 148, 250) rgb(85, 148, 250)"}))});var n=function(){return t(function(){console.log("waited"),S()},100)};z.load().then(function(n){m?a.lazyData[a.lazyDataCollectionKey]=n[a.lazyDataCollectionKey]:angular.forEach(Object.keys(n),function(e){a.lazyData[e]=n[e]}),b=!1},function(e){console.log(e.message),e&&n().then(function(){t.cancel(n)})})};o.$on("hideLoading",function(){a.spinner.hide=!0}),o.$on("showLoading",function(){a.spinner.hide=!1}),d.bind("scroll",function(){!b&&s.scrollY>=f&&(b=!0,s.requestAnimationFrame(function(){a.$apply(function(){S(),f=l(c(),g)})}))}),S()}}}]),angular.module("ngLazy.factories",[]).factory("lazyLoader",["$timeout","$rootScope","$q",function(n,e,a){var t,o,r,i,l,c,d,s,u={data:{}};return{configure:function(n){t=n,o=t.data,r=t.collectionKey,i=t.fetchData,l=t.dataKeys,c=t.range,d=t.appendDelay,s=t.startDelay},getData:function(){var t=a.defer();return e.$broadcast("showLoading"),u.data[r]?n(function(){o[r]=o[r].concat(u.data[r].splice(0,c)),t.resolve(o),e.$broadcast("hideLoading")},d):i().then(function(n){angular.forEach(l,function(e){u.data[e]=n.data[e],e===r?(o[e]=[],o[e]=o[e].concat(u.data[e].splice(0,c))):o[e]=u.data[e]}),t.resolve(o),e.$broadcast("hideLoading")}),t.promise},load:function(){var o=a.defer(),r=this,i=!1;if(e.$broadcast("showLoading"),angular.forEach(Object.keys(t),function(n){t[n]||(i=!0)}),i)o.reject(new Error("Bindings are not yet defined"));else{var l=n(function(){r.getData().then(function(n){o.resolve(n)})},s);l.then(function(){n.cancel(l)})}return o.promise}}}]);